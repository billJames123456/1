(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57055e9a"],{6599:function(e,t,a){"use strict";a("c9e6")},"6dfa":function(e,t,a){},a39c:function(e,t,a){"use strict";a("6dfa")},bb51:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"main"}},[t("el-menu",{ref:"top_menu",style:e.displayTopMenu,attrs:{"default-active":e.activeIndex,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleSelect}},[t("el-menu-item",{attrs:{index:"all"}},[e._v("全 部 图 片")]),t("el-submenu",{staticStyle:{width:"130px"},attrs:{index:"type"}},[t("template",{slot:"title"},[e._v(e._s(e.typeTitle))]),e._l(e.imageTypes,(function(a,i){return t("el-menu-item",{key:i,attrs:{index:a}},[e._v(e._s(a))])}))],2),t("el-submenu",{staticStyle:{width:"130px"},attrs:{index:"time"}},[t("template",{slot:"title"},[e._v(e._s(e.timeTitle))]),e._l(e.imageTimes,(function(a,i){return t("el-menu-item",{key:i,attrs:{index:a}},[e._v(e._s(a))])}))],2),t("el-menu-item",{attrs:{index:"search"}},[t("el-select",{staticStyle:{padding:"0px 20px"},attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:e.placeholder,"remote-method":e.remoteMethod,loading:e.loading},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-menu-item",{attrs:{index:"search,"+e.value[0]}},[e._v("搜 索")])],1),t("div",{style:e.displayCheckedMenu,attrs:{id:"check_menu"}},[t("div",{staticClass:"check_menu_item"},[t("a",{on:{click:function(t){return e.handleCheckAllChange(!1)}}},[t("svg-icon",{attrs:{"icon-file-name":"chacha"}})],1)]),t("div",{staticClass:"check_menu_item check_menu_txt"},[e._v("已选择"+e._s(e.checkedCount)+"张图片")]),t("div",{staticClass:"check_menu_feature"},[t("a",{attrs:{title:"全选图片"},on:{click:function(t){return e.handleCheckAllChange(!e.checkedStatus)}}},[t("svg-icon",{attrs:{"icon-file-name":"all"}})],1),t("a",{attrs:{title:"添加相册"},on:{click:function(t){return e.openAlbum()}}},[t("svg-icon",{attrs:{"icon-file-name":"add"}})],1),t("a",{attrs:{title:"下载图片"},on:{click:function(t){return e.downloadImage()}}},[t("svg-icon",{attrs:{"icon-file-name":"download"}})],1),t("a",{attrs:{title:"删除图片"},on:{click:function(t){return e.deleteImage()}}},[t("svg-icon",{attrs:{"icon-file-name":"delete"}})],1)])]),t("el-dialog",{attrs:{title:"添加相册",visible:e.dialogTableVisible,width:"25%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[t("el-table",{ref:"singleTable",attrs:{data:e.albumData,"show-header":!1,"highlight-current-row":"","max-height":"300px"},on:{"current-change":e.handleTableCurrentChange}},[t("el-table-column",{attrs:{property:"albumImg",label:"描述图片",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("img",{staticStyle:{height:"5em",width:"9em"},attrs:{src:e.serveUrL+a.row.albumImg}})]}}])}),t("el-table-column",{attrs:{property:"albumName",label:"相册名称"}})],1),t("el-button",{staticStyle:{"margin-left":"45%","margin-top":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addAlbum()}}},[e._v("添加 ")])],1),t("div",{attrs:{id:"image-content"}},e._l(e.images,(function(a,i){return t("div",{key:i,staticClass:"image-item",style:e.reactiveImage},[t("el-checkbox-group",{staticClass:"check-box",style:e.displayCheckedMenu,on:{change:e.handleCheckedImgChange},model:{value:e.checkedImgIndex,callback:function(t){e.checkedImgIndex=t},expression:"checkedImgIndex"}},[t("el-checkbox",{attrs:{label:i}})],1),t("el-image",{staticClass:"image",attrs:{src:e.serveUrL+a.compressUrL,"preview-src-list":e.getSrcList(i)}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:!0,expression:"true"}],staticClass:"image-slot",staticStyle:{"margin-top":"40%"},attrs:{slot:"placeholder","element-loading-text":"图片加载中..."},slot:"placeholder"})])],1)})),0),t("div",{attrs:{id:"pagination"}},[t("div",{attrs:{id:"pagination-son"}},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":e.page_size,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)},s=[],l=(a("14d9"),{data(){return{page_size:[10,15,20,25,30,40],options:["s","s"],value:["游乐场"],list:[],states:["风景","动物"],loading:!1,token:"",serveUrL:this.$serveUrL,activeIndex:"all",timeTitle:"拍 摄 时 间",typeTitle:"图 片 类 别",arrPath:["all"],placeholder:"请输入关键词查询图片",isRouterAlive:!0,images:[{imageId:"",compressUrL:"https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg",imageName:""}],previewImageUrL:["https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg"],dialogTableVisible:!1,currentRowData:null,albumData:[{albumName:"",albumImg:"",albumId:""}],reactiveImage:{margin:"0.3em",width:"9%",height:"29%"},imageTypes:["美女","宠物","植物"],imageTimes:["2021-8-26","2022-9-23","2022-9-26"],checkAll:!1,checkedImgIndex:[],checkedImgId:[],isIndeterminate:!1,checkedStatus:!1,checkedCount:0,displayTopMenu:"true",displayCheckedMenu:"",pageSize:20,totalCount:100,currentPage:1}},created(){},beforeCreate(){},mounted(){var e=this.$cookie.getCookie();console.log(e),"token"!=e[0]?(this.$message({message:"登录已过期!",type:"error"}),this.$router.push({name:"login"})):this.token=e[1],this.selectAllTimeType(),this.selectAllImage()},methods:{handleTableCurrentChange(e){this.currentRowData=e},getSrcList(e){return this.previewImageUrL.slice(e).concat(this.previewImageUrL.slice(0,e))},openAlbum(){this.selectAlbums(),this.dialogTableVisible=!0},addAlbum(){this.handleCheckIndexToId();var e=this;const t=new FormData;t.append("token",this.token),t.append("imageId",this.checkedImgId),t.append("albumId",this.currentRowData.albumId),this.axios({url:this.$serveUrL+"/album/addImageToAlbum",method:"post",data:t}).then((function(t){"success"==t.data.status&&(e.$message({message:"添加相册成功！",type:"success"}),e.dialogTableVisible=!1)}))},downloadImage(){var e=this.checkedImgIndex;for(let i=0;i<e.length;i++){let t=this.previewImageUrL[e[i]],a=this.images[e[i]].imageName;this.downloadPicture(t,a)}this.handleCheckIndexToId();var t=this;const a=new FormData;a.append("token",this.token),a.append("number",this.checkedImgId.length),this.axios({url:this.$serveUrL+"/record/recordDownload",method:"post",data:a}).then((function(e){"success"==e.data.status&&(t.$message({message:"图片下载成功！",type:"success"}),t.dialogTableVisible=!1)}))},downloadPicture(e,t){fetch(e).then(e=>{e.blob().then(e=>{const a=window.URL.createObjectURL(e),i=document.createElement("a");i.href=a,i.download=t,i.click(),window.URL.revokeObjectURL(a)})})},deleteImage(){this.$confirm("此操作将删除所选图片, 是否继续?","删除图片",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.handleCheckIndexToId();var e=this;const t=new FormData;t.append("token",this.token),t.append("imageId",this.checkedImgId),this.axios({url:this.$serveUrL+"/image/delete",method:"post",data:t}).then((function(t){"success"==t.data.status&&(e.$message({message:"图片删除成功！",type:"success"}),e.handleCheckAllChange(!1),e.handleSelect("",e.arrPath))}))})},selectAlbums(){var e=this;const t=new FormData;t.append("token",this.token),this.axios({url:this.$serveUrL+"/album/selectAlbumName",method:"post",data:t}).then((function(t){"success"==t.data.status&&(e.albumData=t.data.data)}))},selectAllTimeType(){var e=this;const t=new FormData;let a="/image/selectTimeType";t.append("token",this.token),this.axios({url:this.$serveUrL+a,method:"post",data:t}).then((function(t){if("success"==t.data.status){let a=t.data.data;e.imageTypes=a.imageType,e.imageTimes=a.imageDate,e.isRouterAlive=!e.isRouterAlive}}))},handleSelect(e,t){switch(this.arrPath=t,t[0]){case"all":this.selectAllImage("",""),this.timeTitle="拍 摄 时 间",this.typeTitle="图 片 类 别";break;case"type":this.typeTitle=t[1],this.timeTitle="拍 摄 时 间",this.selectAllImage("type",t[1]);break;case"time":this.timeTitle=t[1],this.typeTitle="图 片 类 别",this.selectAllImage("time",t[1]);break;case"search":break;default:break}},selectAllImage(e,t){var a=this;const i=new FormData;let s="/image/selectAll";i.append("currentPage",this.currentPage),i.append("pageSize",this.pageSize),i.append("token",this.token),"type"==e&&(i.append("imageType",t),s="/image/selectAllByType"),"time"==e&&(i.append("imageDate",t),s="/image/selectAllByTime"),this.axios({url:this.$serveUrL+s,method:"post",data:i}).then((function(e){if("success"==e.data.status){a.images=e.data.data.images,a.previewImageUrL=e.data.data.previewImageUrL;for(var t=0;t<a.previewImageUrL.length;t++)a.previewImageUrL[t]=a.serveUrL+a.previewImageUrL[t];a.totalCount=e.data.data.totalCount,a.isRouterAlive=!a.isRouterAlive}}))},remoteMethod(e){""!==e?(this.loading=!0,setTimeout(()=>{this.loading=!1,this.options=this.list.filter(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)},200)):this.options=[]},SwitchDisplay(e){if(e>0){let e=this.$refs.top_menu.$el["offsetHeight"];"display:none;"==this.displayTopMenu&&""!=this.displayTopMenu||(this.displayCheckedMenu="display:block;height:"+e+"px;",this.displayTopMenu="display:none;")}else this.displayCheckedMenu="",this.displayTopMenu=""},handleCheckAllChange(e){if(e){let e=this.images.length;this.checkedCount=e,this.checkedImgIndex=new Array(e);for(var t=0;t<e;t++)this.checkedImgIndex[t]=t}else this.checkedImgIndex=[],this.checkedCount=0;this.isIndeterminate=!1,this.checkedStatus=e,this.SwitchDisplay(this.checkedCount)},handleCheckIndexToId(){let e=this.checkedImgIndex.length;this.checkedImgId=new Array(e);for(let t=0;t<e;t++)this.checkedImgId[t]=this.images[this.checkedImgIndex[t]].imageId},handleCheckedImgChange(e){this.checkedCount=e.length,this.SwitchDisplay(this.checkedCount),this.checkAll=this.checkedCount===this.images.length,this.isIndeterminate=this.checkedCount>0&&this.checkedCount<this.images.length},handleSizeChange(e){let t=["10%","10%","9%","9%","9%","9%","9%"],a=["29%","29%","29%","29%","26%","27%","21%"];this.reactiveImage.width=t[e/5-2],this.reactiveImage.height=a[e/5-2],this.pageSize=e,this.handleSelect("",this.arrPath)},handleCurrentChange(e){this.currentPage=e,this.handleSelect("",this.arrPath)}}}),n=l,c=(a("a39c"),a("6599"),a("2877")),r=Object(c["a"])(n,i,s,!1,null,"f27fd28a",null);t["default"]=r.exports},c9e6:function(e,t,a){}}]);
//# sourceMappingURL=chunk-57055e9a.72126cc8.js.map